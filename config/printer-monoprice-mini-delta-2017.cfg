[mcu]
serial: /dev/ttyACM0
restart_method: command

[printer]
# some users report better success using the following value for arm_length:
kinematics: delta
max_velocity: 150
max_accel: 1200
max_z_velocity: 100
minimum_z_position: -10
delta_radius: 63
# delta_radius: 62.7

[stepper_a]
# some users report better success using the following value for arm_length:
position_endstop: 125
arm_length: 120.8
# arm_length: 121.36
rotation_distance: 56
step_pin: PB12
dir_pin: PB11
enable_pin: !PB10
microsteps: 16
endstop_pin: ^PC14
homing_speed: 50

[stepper_b]
rotation_distance: 56
step_pin: PB2
dir_pin: PB1
enable_pin: !PB10
microsteps: 16
endstop_pin: ^PC15

[stepper_c]
rotation_distance: 56
step_pin: PB14
dir_pin: PB13
enable_pin: !PB10
microsteps: 16
endstop_pin: ^PC13

[delta_calibrate]
radius: 50

[extruder]
step_pin: PA7
dir_pin: !PA6
enable_pin: !PB0
microsteps: 16
rotation_distance: 65.984
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: PA1
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PA0
control: pid
pid_Kp: 22.2
pid_Ki: 1.08
pid_Kd: 114
min_temp: 0
max_temp: 300

[heater_bed]
heater_pin: PA5
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PA4
control: pid
min_temp: 0
max_temp: 130
pid_Kp: 51.249
pid_Ki: 4.437
pid_Kd: 147.983

[bed_mesh]
mesh_radius: 50

[gcode_macro START_PRINT]
gcode:
    G90 ; switch to absolute positioning - this line was added in case Cura doesn't include it by default
    M82 ; set extruder to absolute mode - this line was added in case Cura doesn't include it by default
    G28 ; start from home position
    BED_MESH_CALIBRATE
    G1 Z15.0 F4800  ; move the nozzle up 15mm
    G92 E0 ; reset extrusion distance
    G1 F200 E5 ; extrude 3mm of feed stock
    G92 E0 ; reset extrusion distance again
    G1 F4800

[gcode_macro END_PRINT]
gcode:
    M104 S0 ; turn off hotend heater
    M140 S0 ; turn off bed heater
    G91 ; Switch to use Relative Coordinates
    G1 E-3 F700 ; retract the filament a bit before lifting the nozzle to release some of the pressure
    G1 Z2 F1000 ; raise platform 2mm from current position
    G1 E-2 F700 ; retract filament even more
    G90 ; Switch back to using absolute coordinates
    G28 X Y Z ; Return to home position. Without an X Y or Z after G28 the print completion time will not be displayed on the Mini Delta's display.
    M84 ; disable motors
    M107 ; turn off fan. Don't use M106 S1. Using M106 S1 may prevent the fan from turning on for the following print. Some say M107 doesn't work for them but if the hotend is below 70 degrees it should work

[probe]
pin: ^!PB7
z_offset: -0.1

[fan]
pin: PA8
